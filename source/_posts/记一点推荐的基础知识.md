---
title: 记一点推荐的基础知识
tags:
  - 推荐
categories: 推荐
typora-root-url: ../../source
date: 2023-11-11 16:52:21
---

推荐水哥的这个[系列](https://zhuanlan.zhihu.com/p/407871839)

我这记一点里面需要注意的知识

# AUC/GAUC

阿里提出了一个新的评价指标 Group AUC，是用户维度加权的auc

$$
GAUC = \frac{\sum w_u AUC_u}{\sum w_u}
$$

这里的w代表权重，可以是曝光数、点击数，更倾向于高活用户。

AUC[这篇](https://tracholar.github.io/machine-learning/2018/01/26/auc.html)写挺好的
- auc曲线横坐标是$FPR=\frac{FP}{FP+TN}$，假阳率，预测为阴性里有多少是阳的，越小越好
- 纵坐标是$FPR=\frac{TP}{TP+FN}$，真阳率，召回率，预测为阳性的里面有多少是真阳性，越大越好
- AUC可以看做随机从正负样本中选取一对正负样本，其中正样本的得分大于负样本的概率
- 可以使用sql来计算AUC
> 假设我们将测试集的正负样本按照模型预测得分**从小到大**排序，对于第j
个正样本，假设它的排序为 rj， 那么说明排在这个正样本前面的总样本有 rj−1
个，其中正样本有 j−1 个（因为这个正样本在所有的正样本里面排第j）， 所以排在第j个正样本前面(得分比它小)的负样本个数为 rj−j个。也就是说，对于第j个正样本来说，其得分比随机取的一个负样本大(排序比它靠后)的概率是 (rj−j)/N−,其中N−是总的负样本数目。所以，平均下来，随机取的正样本得分比负样本大的概率为
> $$
AUC = \frac{1}{N_+} \sum_{j=1}^{N_+}(r_j - j)/N_- \\
= \frac{\sum_{j=1}^{N_+}r_j - N_+(N_+ + 1)/2}{N_+N_-}
$$
```sql
select
	(ry - 0.5*n1*(n1+1))/n0/n1 as auc
from(
	select
		sum(if(y=0, 1, 0)) as n0,
		sum(if(y=1, 1, 0)) as n1,
		sum(if(y=1, r, 0)) as ry
	from(
		select y, row_number() over(order by score asc) as r
		from(
			select y, score
			from some.table
		)A
	)B
)C
```

# NDGC

Normalized Discounted Cumulative Gain

还是这位老哥说得清楚 https://blog.csdn.net/xihuanyuye/article/details/85019816


